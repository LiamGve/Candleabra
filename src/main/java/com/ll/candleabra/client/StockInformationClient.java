package com.ll.candleabra.client;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.ll.candleabra.model.web.StockIntraDayResponse;
import org.springframework.web.client.RestTemplate;

import static java.lang.String.format;

public class StockInformationClient {

    private final RestTemplate restTemplate;
    private final ObjectMapper objectMapper;

    public StockInformationClient(RestTemplate restTemplate,
                                  ObjectMapper objectMapper) {
        this.restTemplate = restTemplate;
        this.objectMapper = objectMapper;
    }

    public StockIntraDayResponse getSockInformationFor1(final String shortCode) {
        return restTemplate.getForObject(format("""
                https://www.alphavantage.co/query
                      ?function=TIME_SERIES_INTRADAY
                      &symbol=%s
                      &interval=5min
                      &apikey=%s
                """, shortCode, "apiKey"), StockIntraDayResponse.class);
    }

    public StockIntraDayResponse getSockInformationFor(final String shortCode) {
        try {
            return objectMapper.readValue(MOCK_RESPONSE, StockIntraDayResponse.class);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
        }
        return null;
    }

    private static String MOCK_RESPONSE = """
            {
                "Meta Data": {
                    "1. Information": "Intraday (5min) open, high, low, close prices and volume",
                    "2. Symbol": "GOOG",
                    "3. Last Refreshed": "2023-02-03 20:00:00",
                    "4. Interval": "5min",
                    "5. Output Size": "Compact",
                    "6. Time Zone": "US/Eastern"
                },
                "Time Series (5min)": {
                    "2023-02-03 20:00:00": {
                        "1. open": "105.1200",
                        "2. high": "105.2600",
                        "3. low": "105.0500",
                        "4. close": "105.2000",
                        "5. volume": "1297"
                    },
                    "2023-02-03 19:55:00": {
                        "1. open": "105.1200",
                        "2. high": "105.1200",
                        "3. low": "105.0600",
                        "4. close": "105.1000",
                        "5. volume": "519"
                    },
                    "2023-02-03 19:50:00": {
                        "1. open": "105.1600",
                        "2. high": "105.2200",
                        "3. low": "105.1000",
                        "4. close": "105.1400",
                        "5. volume": "1585"
                    },
                    "2023-02-03 19:45:00": {
                        "1. open": "105.2999",
                        "2. high": "105.2999",
                        "3. low": "105.1000",
                        "4. close": "105.1100",
                        "5. volume": "2108"
                    },
                    "2023-02-03 19:40:00": {
                        "1. open": "105.0500",
                        "2. high": "105.1000",
                        "3. low": "105.0400",
                        "4. close": "105.0400",
                        "5. volume": "1080"
                    },
                    "2023-02-03 19:35:00": {
                        "1. open": "105.0500",
                        "2. high": "105.0500",
                        "3. low": "105.0400",
                        "4. close": "105.0500",
                        "5. volume": "683"
                    },
                    "2023-02-03 19:30:00": {
                        "1. open": "105.0400",
                        "2. high": "105.0400",
                        "3. low": "105.0400",
                        "4. close": "105.0400",
                        "5. volume": "171"
                    },
                    "2023-02-03 19:25:00": {
                        "1. open": "105.0600",
                        "2. high": "105.0600",
                        "3. low": "105.0600",
                        "4. close": "105.0600",
                        "5. volume": "619"
                    },
                    "2023-02-03 19:20:00": {
                        "1. open": "105.1000",
                        "2. high": "105.1000",
                        "3. low": "105.1000",
                        "4. close": "105.1000",
                        "5. volume": "288"
                    },
                    "2023-02-03 19:10:00": {
                        "1. open": "105.3000",
                        "2. high": "105.3000",
                        "3. low": "105.0300",
                        "4. close": "105.0300",
                        "5. volume": "900"
                    },
                    "2023-02-03 19:05:00": {
                        "1. open": "105.1400",
                        "2. high": "105.1400",
                        "3. low": "105.1400",
                        "4. close": "105.1400",
                        "5. volume": "131"
                    },
                    "2023-02-03 19:00:00": {
                        "1. open": "105.1600",
                        "2. high": "105.1600",
                        "3. low": "105.0200",
                        "4. close": "105.0200",
                        "5. volume": "1209"
                    },
                    "2023-02-03 18:55:00": {
                        "1. open": "105.2000",
                        "2. high": "105.2000",
                        "3. low": "105.2000",
                        "4. close": "105.2000",
                        "5. volume": "502"
                    },
                    "2023-02-03 18:50:00": {
                        "1. open": "105.2000",
                        "2. high": "105.2000",
                        "3. low": "105.2000",
                        "4. close": "105.2000",
                        "5. volume": "600"
                    },
                    "2023-02-03 18:40:00": {
                        "1. open": "105.3700",
                        "2. high": "105.3700",
                        "3. low": "105.2300",
                        "4. close": "105.2300",
                        "5. volume": "2337"
                    },
                    "2023-02-03 18:30:00": {
                        "1. open": "105.2400",
                        "2. high": "105.2400",
                        "3. low": "105.2400",
                        "4. close": "105.2400",
                        "5. volume": "311"
                    },
                    "2023-02-03 18:20:00": {
                        "1. open": "105.3700",
                        "2. high": "105.3700",
                        "3. low": "105.3700",
                        "4. close": "105.3700",
                        "5. volume": "500"
                    },
                    "2023-02-03 18:15:00": {
                        "1. open": "105.4200",
                        "2. high": "105.4200",
                        "3. low": "105.4200",
                        "4. close": "105.4200",
                        "5. volume": "521"
                    },
                    "2023-02-03 18:05:00": {
                        "1. open": "105.2700",
                        "2. high": "105.2700",
                        "3. low": "105.2700",
                        "4. close": "105.2700",
                        "5. volume": "281"
                    },
                    "2023-02-03 18:00:00": {
                        "1. open": "105.3100",
                        "2. high": "105.3200",
                        "3. low": "105.3100",
                        "4. close": "105.3200",
                        "5. volume": "757"
                    },
                    "2023-02-03 17:55:00": {
                        "1. open": "105.3900",
                        "2. high": "105.3900",
                        "3. low": "105.3200",
                        "4. close": "105.3200",
                        "5. volume": "1109"
                    },
                    "2023-02-03 17:50:00": {
                        "1. open": "105.3000",
                        "2. high": "105.3978",
                        "3. low": "105.3000",
                        "4. close": "105.3978",
                        "5. volume": "947"
                    },
                    "2023-02-03 17:45:00": {
                        "1. open": "105.3000",
                        "2. high": "105.3000",
                        "3. low": "105.3000",
                        "4. close": "105.3000",
                        "5. volume": "222"
                    },
                    "2023-02-03 17:40:00": {
                        "1. open": "105.3216",
                        "2. high": "105.3216",
                        "3. low": "105.3216",
                        "4. close": "105.3216",
                        "5. volume": "130"
                    },
                    "2023-02-03 17:35:00": {
                        "1. open": "105.3500",
                        "2. high": "105.3500",
                        "3. low": "105.3500",
                        "4. close": "105.3500",
                        "5. volume": "158"
                    },
                    "2023-02-03 17:30:00": {
                        "1. open": "105.3400",
                        "2. high": "105.3400",
                        "3. low": "105.3400",
                        "4. close": "105.3400",
                        "5. volume": "2330"
                    },
                    "2023-02-03 17:25:00": {
                        "1. open": "105.3000",
                        "2. high": "105.3000",
                        "3. low": "105.3000",
                        "4. close": "105.3000",
                        "5. volume": "129"
                    },
                    "2023-02-03 17:20:00": {
                        "1. open": "105.3400",
                        "2. high": "105.3400",
                        "3. low": "105.3400",
                        "4. close": "105.3400",
                        "5. volume": "322"
                    },
                    "2023-02-03 17:15:00": {
                        "1. open": "105.4133",
                        "2. high": "105.4133",
                        "3. low": "105.2200",
                        "4. close": "105.2200",
                        "5. volume": "48833"
                    },
                    "2023-02-03 17:10:00": {
                        "1. open": "105.3500",
                        "2. high": "105.3500",
                        "3. low": "105.3500",
                        "4. close": "105.3500",
                        "5. volume": "331"
                    },
                    "2023-02-03 17:05:00": {
                        "1. open": "105.2200",
                        "2. high": "105.4027",
                        "3. low": "105.2200",
                        "4. close": "105.3000",
                        "5. volume": "4597"
                    },
                    "2023-02-03 17:00:00": {
                        "1. open": "105.3800",
                        "2. high": "105.4200",
                        "3. low": "105.3000",
                        "4. close": "105.4200",
                        "5. volume": "789"
                    },
                    "2023-02-03 16:55:00": {
                        "1. open": "105.3015",
                        "2. high": "105.3800",
                        "3. low": "105.3015",
                        "4. close": "105.3800",
                        "5. volume": "506"
                    },
                    "2023-02-03 16:50:00": {
                        "1. open": "105.3000",
                        "2. high": "105.3200",
                        "3. low": "105.3000",
                        "4. close": "105.3000",
                        "5. volume": "5776"
                    },
                    "2023-02-03 16:45:00": {
                        "1. open": "105.3100",
                        "2. high": "105.3100",
                        "3. low": "105.3000",
                        "4. close": "105.3000",
                        "5. volume": "303"
                    },
                    "2023-02-03 16:35:00": {
                        "1. open": "105.2800",
                        "2. high": "105.3000",
                        "3. low": "105.2700",
                        "4. close": "105.2700",
                        "5. volume": "1091"
                    },
                    "2023-02-03 16:30:00": {
                        "1. open": "105.2800",
                        "2. high": "105.2999",
                        "3. low": "105.2200",
                        "4. close": "105.2999",
                        "5. volume": "1818"
                    },
                    "2023-02-03 16:25:00": {
                        "1. open": "105.1400",
                        "2. high": "105.2700",
                        "3. low": "105.1400",
                        "4. close": "105.2200",
                        "5. volume": "1573"
                    },
                    "2023-02-03 16:20:00": {
                        "1. open": "105.1800",
                        "2. high": "105.2900",
                        "3. low": "105.1500",
                        "4. close": "105.2900",
                        "5. volume": "95175"
                    },
                    "2023-02-03 16:15:00": {
                        "1. open": "105.2200",
                        "2. high": "105.2200",
                        "3. low": "105.1900",
                        "4. close": "105.1900",
                        "5. volume": "64612"
                    },
                    "2023-02-03 16:10:00": {
                        "1. open": "105.1900",
                        "2. high": "105.2100",
                        "3. low": "105.1900",
                        "4. close": "105.2000",
                        "5. volume": "1493"
                    },
                    "2023-02-03 16:05:00": {
                        "1. open": "105.2200",
                        "2. high": "105.4900",
                        "3. low": "105.1900",
                        "4. close": "105.2000",
                        "5. volume": "1008067"
                    },
                    "2023-02-03 16:00:00": {
                        "1. open": "105.4050",
                        "2. high": "105.5600",
                        "3. low": "105.1901",
                        "4. close": "105.2100",
                        "5. volume": "1228988"
                    },
                    "2023-02-03 15:55:00": {
                        "1. open": "105.0300",
                        "2. high": "105.4500",
                        "3. low": "104.8900",
                        "4. close": "105.4000",
                        "5. volume": "772316"
                    },
                    "2023-02-03 15:50:00": {
                        "1. open": "105.1000",
                        "2. high": "105.2400",
                        "3. low": "105.0008",
                        "4. close": "105.0300",
                        "5. volume": "365980"
                    },
                    "2023-02-03 15:45:00": {
                        "1. open": "105.0200",
                        "2. high": "105.2000",
                        "3. low": "104.9900",
                        "4. close": "105.1000",
                        "5. volume": "320842"
                    },
                    "2023-02-03 15:40:00": {
                        "1. open": "105.0200",
                        "2. high": "105.1500",
                        "3. low": "104.9400",
                        "4. close": "105.0101",
                        "5. volume": "244346"
                    },
                    "2023-02-03 15:35:00": {
                        "1. open": "105.0800",
                        "2. high": "105.1900",
                        "3. low": "104.9700",
                        "4. close": "105.0400",
                        "5. volume": "244848"
                    },
                    "2023-02-03 15:30:00": {
                        "1. open": "105.0800",
                        "2. high": "105.2100",
                        "3. low": "105.0200",
                        "4. close": "105.0750",
                        "5. volume": "215390"
                    },
                    "2023-02-03 15:25:00": {
                        "1. open": "105.0700",
                        "2. high": "105.0965",
                        "3. low": "104.9401",
                        "4. close": "105.0800",
                        "5. volume": "221814"
                    },
                    "2023-02-03 15:20:00": {
                        "1. open": "104.9700",
                        "2. high": "105.2600",
                        "3. low": "104.8800",
                        "4. close": "105.0700",
                        "5. volume": "255189"
                    },
                    "2023-02-03 15:15:00": {
                        "1. open": "104.8450",
                        "2. high": "105.0450",
                        "3. low": "104.7800",
                        "4. close": "104.9850",
                        "5. volume": "237199"
                    },
                    "2023-02-03 15:10:00": {
                        "1. open": "104.6300",
                        "2. high": "104.9200",
                        "3. low": "104.6000",
                        "4. close": "104.8450",
                        "5. volume": "232602"
                    },
                    "2023-02-03 15:05:00": {
                        "1. open": "104.6000",
                        "2. high": "104.6500",
                        "3. low": "104.4400",
                        "4. close": "104.6300",
                        "5. volume": "235813"
                    },
                    "2023-02-03 15:00:00": {
                        "1. open": "104.8500",
                        "2. high": "104.9000",
                        "3. low": "104.5000",
                        "4. close": "104.6000",
                        "5. volume": "213003"
                    },
                    "2023-02-03 14:55:00": {
                        "1. open": "105.0700",
                        "2. high": "105.0800",
                        "3. low": "104.8100",
                        "4. close": "104.8600",
                        "5. volume": "202775"
                    },
                    "2023-02-03 14:50:00": {
                        "1. open": "105.0500",
                        "2. high": "105.1100",
                        "3. low": "104.9300",
                        "4. close": "105.0800",
                        "5. volume": "152943"
                    },
                    "2023-02-03 14:45:00": {
                        "1. open": "105.1700",
                        "2. high": "105.1900",
                        "3. low": "105.0100",
                        "4. close": "105.0500",
                        "5. volume": "150382"
                    },
                    "2023-02-03 14:40:00": {
                        "1. open": "104.9700",
                        "2. high": "105.2600",
                        "3. low": "104.9400",
                        "4. close": "105.1800",
                        "5. volume": "179476"
                    },
                    "2023-02-03 14:35:00": {
                        "1. open": "105.0700",
                        "2. high": "105.0900",
                        "3. low": "104.8900",
                        "4. close": "104.9700",
                        "5. volume": "321520"
                    },
                    "2023-02-03 14:30:00": {
                        "1. open": "104.9100",
                        "2. high": "105.1250",
                        "3. low": "104.8900",
                        "4. close": "105.0700",
                        "5. volume": "199504"
                    },
                    "2023-02-03 14:25:00": {
                        "1. open": "104.8800",
                        "2. high": "105.0700",
                        "3. low": "104.8300",
                        "4. close": "104.9200",
                        "5. volume": "305465"
                    },
                    "2023-02-03 14:20:00": {
                        "1. open": "105.4300",
                        "2. high": "105.4300",
                        "3. low": "104.8200",
                        "4. close": "104.8700",
                        "5. volume": "264241"
                    },
                    "2023-02-03 14:15:00": {
                        "1. open": "105.4700",
                        "2. high": "105.4850",
                        "3. low": "105.1600",
                        "4. close": "105.4350",
                        "5. volume": "141720"
                    },
                    "2023-02-03 14:10:00": {
                        "1. open": "105.5400",
                        "2. high": "105.6200",
                        "3. low": "105.3800",
                        "4. close": "105.4501",
                        "5. volume": "261270"
                    },
                    "2023-02-03 14:05:00": {
                        "1. open": "105.6400",
                        "2. high": "105.8000",
                        "3. low": "105.4900",
                        "4. close": "105.5301",
                        "5. volume": "174769"
                    },
                    "2023-02-03 14:00:00": {
                        "1. open": "105.7400",
                        "2. high": "105.7400",
                        "3. low": "105.5400",
                        "4. close": "105.6400",
                        "5. volume": "191389"
                    },
                    "2023-02-03 13:55:00": {
                        "1. open": "105.2400",
                        "2. high": "105.7600",
                        "3. low": "105.2200",
                        "4. close": "105.7200",
                        "5. volume": "312540"
                    },
                    "2023-02-03 13:50:00": {
                        "1. open": "105.2500",
                        "2. high": "105.3900",
                        "3. low": "104.9400",
                        "4. close": "105.2200",
                        "5. volume": "376290"
                    },
                    "2023-02-03 13:45:00": {
                        "1. open": "105.4650",
                        "2. high": "105.4800",
                        "3. low": "105.2200",
                        "4. close": "105.2650",
                        "5. volume": "180307"
                    },
                    "2023-02-03 13:40:00": {
                        "1. open": "105.2300",
                        "2. high": "105.6300",
                        "3. low": "105.1700",
                        "4. close": "105.4700",
                        "5. volume": "241459"
                    },
                    "2023-02-03 13:35:00": {
                        "1. open": "105.5700",
                        "2. high": "105.5800",
                        "3. low": "105.2100",
                        "4. close": "105.2300",
                        "5. volume": "281846"
                    },
                    "2023-02-03 13:30:00": {
                        "1. open": "105.9600",
                        "2. high": "106.0000",
                        "3. low": "105.5600",
                        "4. close": "105.5801",
                        "5. volume": "263643"
                    },
                    "2023-02-03 13:25:00": {
                        "1. open": "105.9200",
                        "2. high": "106.1000",
                        "3. low": "105.8500",
                        "4. close": "105.9500",
                        "5. volume": "209573"
                    },
                    "2023-02-03 13:20:00": {
                        "1. open": "106.0100",
                        "2. high": "106.1600",
                        "3. low": "105.9200",
                        "4. close": "105.9200",
                        "5. volume": "288719"
                    },
                    "2023-02-03 13:15:00": {
                        "1. open": "105.7000",
                        "2. high": "106.0300",
                        "3. low": "105.6000",
                        "4. close": "106.0100",
                        "5. volume": "177104"
                    },
                    "2023-02-03 13:10:00": {
                        "1. open": "105.8700",
                        "2. high": "106.0350",
                        "3. low": "105.6500",
                        "4. close": "105.7100",
                        "5. volume": "209859"
                    },
                    "2023-02-03 13:05:00": {
                        "1. open": "105.9200",
                        "2. high": "106.0700",
                        "3. low": "105.8100",
                        "4. close": "105.8800",
                        "5. volume": "281739"
                    },
                    "2023-02-03 13:00:00": {
                        "1. open": "106.5950",
                        "2. high": "106.6343",
                        "3. low": "105.8100",
                        "4. close": "105.9103",
                        "5. volume": "386786"
                    },
                    "2023-02-03 12:55:00": {
                        "1. open": "106.5900",
                        "2. high": "106.7700",
                        "3. low": "106.5000",
                        "4. close": "106.6000",
                        "5. volume": "203179"
                    },
                    "2023-02-03 12:50:00": {
                        "1. open": "106.5100",
                        "2. high": "106.8100",
                        "3. low": "106.4800",
                        "4. close": "106.5840",
                        "5. volume": "166579"
                    },
                    "2023-02-03 12:45:00": {
                        "1. open": "106.2750",
                        "2. high": "106.5400",
                        "3. low": "106.2000",
                        "4. close": "106.5200",
                        "5. volume": "233522"
                    },
                    "2023-02-03 12:40:00": {
                        "1. open": "106.3900",
                        "2. high": "106.4699",
                        "3. low": "106.2600",
                        "4. close": "106.2800",
                        "5. volume": "254352"
                    },
                    "2023-02-03 12:35:00": {
                        "1. open": "106.7700",
                        "2. high": "106.7700",
                        "3. low": "106.3400",
                        "4. close": "106.3900",
                        "5. volume": "313017"
                    },
                    "2023-02-03 12:30:00": {
                        "1. open": "106.9000",
                        "2. high": "106.9800",
                        "3. low": "106.7500",
                        "4. close": "106.7800",
                        "5. volume": "170309"
                    },
                    "2023-02-03 12:25:00": {
                        "1. open": "106.8500",
                        "2. high": "106.9700",
                        "3. low": "106.7000",
                        "4. close": "106.8800",
                        "5. volume": "210674"
                    },
                    "2023-02-03 12:20:00": {
                        "1. open": "107.1200",
                        "2. high": "107.1200",
                        "3. low": "106.7700",
                        "4. close": "106.8600",
                        "5. volume": "205838"
                    },
                    "2023-02-03 12:15:00": {
                        "1. open": "107.0900",
                        "2. high": "107.2950",
                        "3. low": "106.9700",
                        "4. close": "107.1300",
                        "5. volume": "174293"
                    },
                    "2023-02-03 12:10:00": {
                        "1. open": "106.9600",
                        "2. high": "107.3100",
                        "3. low": "106.9000",
                        "4. close": "107.0900",
                        "5. volume": "213722"
                    },
                    "2023-02-03 12:05:00": {
                        "1. open": "106.9365",
                        "2. high": "107.2000",
                        "3. low": "106.8200",
                        "4. close": "106.9700",
                        "5. volume": "249191"
                    },
                    "2023-02-03 12:00:00": {
                        "1. open": "107.1900",
                        "2. high": "107.3400",
                        "3. low": "106.8600",
                        "4. close": "106.9350",
                        "5. volume": "251495"
                    },
                    "2023-02-03 11:55:00": {
                        "1. open": "107.2600",
                        "2. high": "107.5300",
                        "3. low": "107.1600",
                        "4. close": "107.1900",
                        "5. volume": "244228"
                    },
                    "2023-02-03 11:50:00": {
                        "1. open": "107.7000",
                        "2. high": "107.7999",
                        "3. low": "107.2500",
                        "4. close": "107.2800",
                        "5. volume": "284396"
                    },
                    "2023-02-03 11:45:00": {
                        "1. open": "107.5600",
                        "2. high": "107.8500",
                        "3. low": "107.2700",
                        "4. close": "107.6864",
                        "5. volume": "303020"
                    },
                    "2023-02-03 11:40:00": {
                        "1. open": "107.7000",
                        "2. high": "108.0200",
                        "3. low": "107.4200",
                        "4. close": "107.5600",
                        "5. volume": "636450"
                    },
                    "2023-02-03 11:35:00": {
                        "1. open": "107.1500",
                        "2. high": "107.7100",
                        "3. low": "107.0268",
                        "4. close": "107.7000",
                        "5. volume": "297758"
                    },
                    "2023-02-03 11:30:00": {
                        "1. open": "107.1400",
                        "2. high": "107.3150",
                        "3. low": "106.8100",
                        "4. close": "107.1500",
                        "5. volume": "392360"
                    },
                    "2023-02-03 11:25:00": {
                        "1. open": "107.3700",
                        "2. high": "107.3750",
                        "3. low": "107.1200",
                        "4. close": "107.1400",
                        "5. volume": "201854"
                    },
                    "2023-02-03 11:20:00": {
                        "1. open": "106.9600",
                        "2. high": "107.4100",
                        "3. low": "106.9600",
                        "4. close": "107.3700",
                        "5. volume": "264653"
                    },
                    "2023-02-03 11:15:00": {
                        "1. open": "107.3100",
                        "2. high": "107.3100",
                        "3. low": "106.8700",
                        "4. close": "106.9700",
                        "5. volume": "331549"
                    }
                }
            }
            """;
}
